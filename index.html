<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Moksi Gaming — Valorant (Draxon)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --bg:#121212; --card:#1e1e1e; --ink:#eee; --accent:#00bcd4; --edge:#333; }
    * { box-sizing: border-box; }
    body { margin:0; background:var(--bg); color:var(--ink); font-family:Arial,sans-serif; padding-top:72px; text-align:center; }
    header { position:fixed; top:0; left:0; right:0; background:var(--card); border-bottom:2px solid var(--accent); padding:14px 0; font-weight:700; box-shadow:0 2px 10px rgba(0,0,0,.5); }
    h1 { margin:24px 0 12px; }
    .wrap { width:min(900px,92vw); margin:0 auto 32px; }
    .card { background:var(--card); border:1px solid var(--edge); border-radius:12px; padding:16px 18px; text-align:left; box-shadow:0 0 10px rgba(0,0,0,.5); }
    .card h2 { margin:0 0 10px; color:var(--accent); font-size:1.1rem; }
    .stat { margin:.35rem 0; }
    footer { margin:20px 0; color:#bbb; font-size:.9rem; }
  </style>
</head>
<body>
  <header>Moksi Gaming — Valorant (Draxon)</header>

  <div class="wrap">
    <h1>Valorant Stats</h1>
    <div class="card">
      <h2>Profiel</h2>
      <p class="stat" id="val-rank">Rank:</p>
      <p class="stat" id="val-kd">K/D:</p>
      <p class="stat" id="val-win">Winrate:</p>
      <p class="stat" id="val-matches">Matches:</p>
      <p class="stat" id="val-agent">Top Agent:</p>
      <p class="stat" id="val-playlist">Playlist:</p>
      <p class="stat" id="val-season">Season:</p>
    </div>
  </div>

  <footer id="updated">Updated: —</footer>

  <script>
    // Laadt lokale JSON die door jouw Action / handmatig is geplaatst.
    const cacheBust = '?v=' + Date.now();
    const valUrl = './data/valorant_draxon.json' + cacheBust;

    const isNumeric = (v) => typeof v === 'number' || (!!v && !isNaN(parseFloat(v)));
    function setText(id, label, value, suffix = '') {
      const el = document.getElementById(id);
      if (!el) return;
      let out = 'N/A';
      if (value !== undefined && value !== null && value !== '') {
        if (suffix && isNumeric(value) && String(value).indexOf('%') === -1) {
          out = `${value}${suffix}`;
        } else {
          out = value;
        }
      }
      el.textContent = `${label}: ${out}`;
    }

    fetch(valUrl)
      .then(r => r.json())
      .then(v => {
        setText('val-rank', 'Rank', v.rank);
        setText('val-kd', 'K/D', v.kd);
        setText('val-win', 'Winrate', v.winrate);         // voeg geen extra % toe als het al "52%" is
        setText('val-matches', 'Matches', v.matches);
        setText('val-agent', 'Top Agent', v.topAgent);
        setText('val-playlist', 'Playlist', v?.filters?.playlist || 'N/A');
        setText('val-season', 'Season', v?.filters?.season || 'N/A');

        document.getElementById('updated').textContent =
          'Updated: ' + (v.generatedAt ? new Date(v.generatedAt).toLocaleString() : '—');
      })
      .catch(() => {
        // Laat labels staan met N/A als het bestand (nog) niet bestaat
        ['val-rank','val-kd','val-win','val-matches','val-agent','val-playlist','val-season']
          .forEach(id => {
            const label = document.getElementById(id).textContent.split(':')[0];
            document.getElementById(id).textContent = `${label}: N/A`;
          });
      });
  </script>
</body>
</html>
